# see http://tracker.ceph.com/issues/20360 and http://tracker.ceph.com/issues/18126
os_type: centos

tasks:
- install:
    flavor: notcmalloc
- ceph:
- rgw:
    client.0:
      valgrind: [--tool=memcheck, --max-threads=1024] # http://tracker.ceph.com/issues/25214
- s3tests:
    client.0:
      force-branch: ceph-luminous
      rgw_server: client.0
- swift:
    client.0:
      rgw_server: client.0
- ragweed:
    client.0:
      force-branch: ceph-luminous
      rgw_server: client.0
      stages: prepare,check
overrides:
  ceph:
    conf:
      global:
        osd_min_pg_log_entries: 10
        osd_max_pg_log_entries: 10
      client:
        rgw lc debug interval: 10
