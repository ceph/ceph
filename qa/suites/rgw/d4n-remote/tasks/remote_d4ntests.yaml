overrides:
  ceph:
    conf:
      client:
      c1.client.0:
        setuser: ceph
        setgroup: ceph
        debug rgw: 20
        rgw filter: d4n
        rgw d4n cache cleaning interval: 5
        rgw local cache address: "127.0.0.1:8000"
        rgw remote cache address: "127.0.0.1:8001"
        rgw d4n backend address: "127.0.0.1:8000"
        d4n writecache enabled: true
      c2.client.0:
        setuser: ceph
        setgroup: ceph
        debug rgw: 20
        rgw filter: d4n
        rgw local cache address: "127.0.0.1:8001" 
        d4n writecache enabled: true
tasks:
- install:
    # extra packages added for the rgw-d4ntests task
    extra_system_packages:
      deb: ['s3cmd', 'redis']
      rpm: ['s3cmd', 'redis']
- ceph: {cluster: c1}
- ceph: {cluster: c2}
- redis:
    c1.client.0:
    c2.client.0:
- tox: [c1.client.0]
- tox: [c2.client.0]
- rgw:
    c1.client.0:
      port: 8000
    c2.client.0:
      port: 8001
- exec:
    c1.client.0:
      - sudo chmod 0777 /var/lib/ceph
      - sudo chmod 0777 /var/lib/ceph/radosgw
    c2.client.0:
      - sudo chmod 0777 /var/lib/ceph
      - sudo chmod 0777 /var/lib/ceph/radosgw
- d4ntestsremote:
    c1.client.0:
    c2.client.0:
- workunit:
    clients:
      c1.client.0:
        - rgw/run-d4n-remote.sh
