tasks:
- install:
    # extra packages added for the rgw-d4ntests task
    extra_system_packages:
      deb: ['s3cmd', 'redis']
      rpm: ['s3cmd', 'redis']
- ceph: {cluster: c1}
- ceph: {cluster: c2}
- redis:
    c1.client.0:
    c2.client.0:
- tox: [c1.client.0]
- tox: [c2.client.0]
- rgw:
    c1.client.0:
      port: 8001
    c2.client.0:
      port: 8002
- exec:
    c1.client.0:
      - sudo chmod 0777 /var/lib/ceph
      - sudo chmod 0777 /var/lib/ceph/radosgw
    c2.client.0:
      - sudo chmod 0777 /var/lib/ceph
      - sudo chmod 0777 /var/lib/ceph/radosgw
- d4ntests:
    c1.client.0:
    c2.client.0:
- workunit:
    clients:
      c1.client.0:
        - rgw/run-d4n-remote.sh
