  <cds-modal size="lg"
             [open]="open"
             (overlaySelected)="closeModal()">
<cds-modal-header (closeSelect)="closeModal()"
                  i18n>
  {{editMode ? 'Edit' : 'Add'}} Matcher configuration
  <cd-help-text [formAllFieldsRequired]="false">All fields are required except Use expression field</cd-help-text>
</cds-modal-header>
<ng-container>
  <section cdsModalContent>
    <form name="form"
          #formDir="ngForm"
          [formGroup]="form"
          novalidate>
    <!-- Name -->
    <div cdsRow
         class="form-item form-item-append">
      <div cdsCol>
        <cds-select id="name"
                    formControlName="name"
                    cdRequiredField="Name"
                    label="Name"
                    i18n-label
                    placeholder="Select a name..."
                    i18n-placeholder
                    [invalid]="form.controls.name.invalid && form.controls.name.dirty"
                    [invalidText]="nameError"
                    helperText="This name will define and control the matcher settings"
                    i18n-helperText>
        <option [ngValue]="null"
                i18n>-- Select an attribute to match against --</option>
        <option *ngFor="let attribute of nameAttributes"
                [value]="attribute">
        {{ attribute }}
        </option>
        </cds-select>
        <ng-template #nameError>
          <span *ngIf="form.showError('name', formDir, 'required')"
                class="invalid-feedback">
            <ng-container i18n>This field is required.</ng-container>
          </span>
        </ng-template>
      </div>
    </div>
    <div cdsRow
         class="form-item form-item-append">
      <!-- Value -->
      <div cdsCol>
        <cds-combo-box label="Value"
                       cdsRequiredField="Value"
                       for="value"
                       formControlName="value"
                       id="value"
                       placeholder="Select Values..."
                       i18n-placeholder
                       [appendInline]="true"
                       [items]="allPossibleValues"
                       itemValueKey="content"
                       cdDynamicInputCombobox
                       [helperText]="valueMatch"
                       i18n-helperText
                       (updatedItems)="allPossibleValues = $event"
                       i18n>
        <cds-dropdown-list></cds-dropdown-list>
        </cds-combo-box>
        <!-- Error Message -->
        <ng-template #valueError>
          <span *ngIf="form.showError('value', formDir, 'required')"
                class="invalid-feedback">
            <ng-container i18n>This field is required.</ng-container>
          </span>
        </ng-template>
        <ng-template #valueMatch>
          <div *ngIf="form.getValue('value') && !form.getValue('isRegex') && matcherMatch"
               id="match-state">
            <span class="text-muted {{matcherMatch.cssClass}}">
            {{matcherMatch.status}}
            </span>
          </div>
        </ng-template>
      </div>
    </div>
    <div cdsRow
         class="form-item form-item-append">
      <div cdsCol>
        <!-- Is Regex -->
        <cds-checkbox id="isRegex"
                      formControlName="isRegex"
                      i18n>
          Use regular expression
        </cds-checkbox>
      </div>
    </div>
    </form>
  </section>
</ng-container>
<!-- Submit Button -->
<cd-form-button-panel (submitActionEvent)="onSubmit()"
                      [form]="form"
                      [submitText]="getMode()"
                      [modalForm]="true"> </cd-form-button-panel>
</cds-modal>
