.TH "MONMAPTOOL" "8" "April 29, 2013" "dev" "Ceph"
.SH NAME
monmaptool \- ceph monitor cluster map manipulation tool
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.\" Man page generated from reStructuredText.
.
.SH SYNOPSIS
.nf
\fBmonmaptool\fP \fImapfilename\fP [ \-\-clobber ] [ \-\-print ] [ \-\-create ]
[ \-\-add \fIip\fP:\fIport\fP \fI...\fP ] [ \-\-rm \fIip\fP:\fIport\fP \fI...\fP ]
.fi
.sp
.SH DESCRIPTION
.sp
\fBmonmaptool\fP is a utility to create, view, and modify a monitor
cluster map for the Ceph distributed file system. The monitor map
specifies the only fixed addresses in the Ceph distributed system.
All other daemons bind to arbitrary addresses and register themselves
with the monitors.
.sp
When creating a map with \-\-create, a new monitor map with a new,
random UUID will be created. It should be followed by one or more
monitor addresses.
.sp
The default Ceph monitor port is 6789.
.SH OPTIONS
.INDENT 0.0
.TP
.B \-\-print
will print a plaintext dump of the map, after any modifications are
made.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-clobber
will allow monmaptool to overwrite mapfilename if changes are made.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-create
will create a new monitor map with a new UUID (and with it, a new,
empty Ceph file system).
.UNINDENT
.INDENT 0.0
.TP
.B \-\-generate
generate a new monmap based on the values on the command line or specified
in the ceph configuration.  This is, in order of preference,
.INDENT 7.0
.INDENT 3.5
.INDENT 0.0
.IP 1. 3
\fB\-\-monmap filename\fP to specify a monmap to load
.IP 2. 3
\fB\-\-mon\-host \(aqhost1,ip2\(aq\fP to specify a list of hosts or ip addresses
.IP 3. 3
\fB[mon.foo]\fP sections containing \fBmon addr\fP settings in the config
.UNINDENT
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.TP
.B \-\-filter\-initial\-members
filter the initial monmap by applying the \fBmon initial members\fP
setting.  Monitors not present in that list will be removed, and
initial members not present in the map will be added with dummy
addresses.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-add name ip:port
will add a monitor with the specified ip:port to the map.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-rm name
will remove the monitor with the specified ip:port from the map.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-fsid uuid
will set the fsid to the given uuid.  If not specified with \-\-create, a random fsid will be generated.
.UNINDENT
.SH EXAMPLE
.sp
To create a new map with three monitors (for a fresh Ceph file system):
.sp
.nf
.ft C
monmaptool  \-\-create  \-\-add  mon.a 192.168.0.10:6789 \-\-add mon.b 192.168.0.11:6789 \e
  \-\-add mon.c 192.168.0.12:6789 \-\-clobber monmap
.ft P
.fi
.sp
To display the contents of the map:
.sp
.nf
.ft C
monmaptool \-\-print onmap
.ft P
.fi
.sp
To replace one monitor:
.sp
.nf
.ft C
monmaptool \-\-rm mon.a \-\-add mon.a 192.168.0.9:6789 \-\-clobber monmap
.ft P
.fi
.SH AVAILABILITY
.sp
\fBmonmaptool\fP is part of the Ceph distributed file system.  Please
refer to the Ceph documentation at \fI\%http://ceph.com/docs\fP for more
information.
.SH SEE ALSO
.sp
\fBceph\fP(8),
\fBcrushtool\fP(8),
\fBmkcephfs\fP(8)
.SH COPYRIGHT
2010-2013, Inktank Storage, Inc. and contributors. Licensed under Creative Commons BY-SA
.\" Generated by docutils manpage writer.
.
